\section{Numerical Analysis}
Differential equations describing the circuit under all four modes of operation have been derived:
\begin{itemize}
    \item \eqref{eq:noLoad_diffEq1} \eqref{eq:noLoad_diffEq2} describe the circuit under \textbf{no load}
    \item \eqref{eq:resistiveLoad_DiffEq1} \eqref{eq:resistiveLoad_DiffEq2}  describe the circuit under a \textbf{resistive load}
    \item \eqref{eq:inductiveLoad_DiffEq1} \eqref{eq:inductiveLoad_DiffEq2} \eqref{eq:inductiveLoad_DiffEq3} \eqref{eq:inductiveLoad_DiffEq4} describe the circuit under an \textbf{inductive load}
    \item \eqref{eq:fullLoad_DiffEq1} \eqref{eq:fullLoad_DiffEq2} \eqref{eq:fullLoad_DiffEq3} \eqref{eq:fullLoad_DiffEq4} describe the circuit under a \textbf{full load}
\end{itemize}

The 4th order variation of the Runge-Kutta (RK4) method is used to solve these differential equations

\subsection{Runge-Kutta Method}
\subsubsection{Overview}
Runge-Kutta is a numerical method used to solve initial value ordinary differential equations
\begin{itemize}
    \item It approximates the solution by dividing the interval into smaller steps and iteratively computing the solution at each step \citep{rungeKutta}
    \item The fourth order variation of Runge-Kutta (RK4) is used in this numerical analysis as it offers a good balance between accuracy and computation cost
\end{itemize}

The core mechanism of the Runge-Kutta method encompasses the evaluation of derivatives at multiple instances within a specific time interval, $h$. Through this process, an estimation of the function's subsequent value is projected. This strategy achieves its efficacy by implementing an approximation to the Taylor series, truncated according to the designated step size, $h$ \citep{rungeKutta}
\leavevmode\newline

For a first-order ODE defined as $\frac{dy}{dt} = f(t, y)$ the application of RK4 to progress from time $t$ to $t + h$ would involve the following steps:
\begin{equation}
\begin{aligned}
k_1 &= hf(t, y), \\
k_2 &= hf(t + \frac{h}{2}, y + \frac{k_1}{2}), \\
k_3 &= hf(t + \frac{h}{2}, y + \frac{k_2}{2}), \\
k_4 &= hf(t + h, y + k_3), \\
y(t + h) &= y(t) + \frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4).
\end{aligned}
\end{equation}

In this instance, the calculated 'k' values represent estimations of the function's slope at diverse points within the time step. The method essentially involves crafting a weighted mean of these slopes to derive the next value.\\

Let us define the next step in the solution, $y_{n+1}$, by the equation
\begin{equation}
y_{n+1} = y_n + \frac{h}{6} (k_1 + 2k_2 + 2k_3 + k_4) \quad (3.1)
\end{equation}
Here, $h$ represents the increment in the value of $t$ at each step.

The coefficients $k_i$ denote the slopes at different points in the time step and are defined as follows:
\begin{equation}
f(t, y) = \frac{dy}{dt}\bigg|_{(t, y)} = y'(t, y) \quad (3.2)
\end{equation}
\begin{align*}
k_1 &= f(t_n, y_n), &\text{initial slope using Euler's method},\\
k_2 &= f \left(t_n + \frac{h}{2}, y_n + \frac{k_1}{2}\right), &\text{slope at the midpoint using $y$ and $k_1$},\\
k_3 &= f \left(t_n + \frac{h}{2}, y_n + \frac{k_2}{2}\right), &\text{slope at the midpoint using $y$ and $k_2$},\\
k_4 &= f(t_n + h, y_n + k_3), &\text{slope at the end of the interval using $y$ and $k_3$}.
\end{align*}

These coefficients are defined for $n = 0, 1, 2, 3, \ldots$ . It can be clearly observed that this method bestows higher weights to the midpoint slopes during the computation of their weighted average.

RK4 can be conveniently extended to cater to systems of ordinary differential equations by replacing $y_n$ with the corresponding vector of unknowns.

Four distinctive scenarios are to be considered, each featuring diverse loads connected to the DC rectifier. These will be thoroughly analyzed individually. In the derivation of the equations, an emphasis is placed on optimizing them to incorporate a minimal number of operations. The priority order is addition, multiplication, and division, enabling a reduction in the utilized machine cycles.

\begin{center}
 Establishing Initial Conditions for the Runge-Kutta Algorithm
\end{center}\leavevmode\newline

The Runge-Kutta algorithm, like any other method used for numerically solving ordinary differential equations, requires predefined initial conditions to initiate its iteration process. These initial conditions serve as the springboard for the subsequent calculations. In the context of an electrical circuit, these conditions are established based on the state of the system at the start time, typically denoted as t = 0s.

For a circuit that has been left in a stationary state before power supply is connected, we can infer that all transient effects have subsided and the system is in a state of equilibrium. As such, it's reasonable to assume that the capacitor in the circuit is completely discharged, indicating a zero voltage across it. Similarly, no currents are flowing through the circuit elements as no potential difference exists to drive them. These constitute the initial conditions at the outset for the Runge-Kutta algorithm's iterations.

\begin{center}
     No-Load Behavior and Single Reactive Element Analysis
\end{center}\leavevmode\newline

Under a no-load condition, where the output is an open circuit, the system exhibits a distinct behavior. In such cases, it is evident that the system involves a single reactive element, specifically a capacitor. Consequently, the complexity of the system is reduced, and it can be described by a single ordinary differential equation (ODE). This ODE captures the relationship between the variables \(y\) and its derivative \(y'\), serving as a fundamental equation governing the system's behavior in the absence of a load. By analyzing and solving this ODE, we can gain insights into the dynamics and characteristics of the system when it operates without any external load connected to it.\\

Consequently, we can express the resulting equations for \(y\) and \(y'\) (the derivatives of \(y\)) as follows:\\

\begin{equation}
    y=[V_a]    
\end{equation}\\

\begin{equation}
    y'=[\frac{dV_a}{dt}]=[\frac{i_c}{C}]
\end{equation}\\

The expression for $y'$ of the Zener diode in the reverse-biased state can be obtained by utilizing Equation (1.65):

\begin{equation}
    \frac{d(e_2)}{dt}=\frac{1}{C}\sbracket{\bracket{\frac{\frac{e_1 - e_2}{2} - V_{th}}{R_b}}\cdot u\bracket{\frac{e_1 - e_2}{2} - V_{th}}-\frac{e_2-V_z}{R_s+R_z}} \hspace{0.1cm} \text{for} \hspace{0.1cm} e_2 \geq V_z
\end{equation}\\

\begin{equation}
    => y'=\frac{1}{C}[(u(\frac{V_2-e_2}{2}-V_{th})(\frac{\frac{V_2-e_2}{2}-V_{th}}{R_b})-\frac{V_a-V_z}{R_s+R_z}]
\end{equation}\\

The expression for $y'$ of the Zener diode in the cut-off state can be obtained by utilizing Equation (1.58):

\begin{equation}
     \frac{d(e_2)}{dt}=\frac{1}{C} \sbracket{\bracket{\frac{\frac{e_1 - e_2}{2} - V_{th}}{R_b}} \cdot u\bracket{\frac{e_1-e_2}{2}-V_{th}}} \hspace{0.5cm} \text{for} \hspace{0.1cm} e_2 < V_z
    \label{eq:de2dt_reverse_bias}
\end{equation}\\

\begin{equation}
    =>y'=\frac{1}{C}[u(\frac{V_2-V_a}{2}-V_t)\frac{\frac{V_2-V_a}{2}-V_t}{R_d}]
\end{equation}\\

The voltage of the capacitor for the next iteration in the Runge-Kutta algorithm can be calculated using Equations (2.7) and (2.9), taking into account the state of the Zener diode. Additional parameters can be determined by considering the input voltages $V_2$ and Va at each iteration.

To evaluate the state of the Zener diode, the voltage across it is examined at the beginning of each iteration. If this voltage is equal to or exceeds the threshold voltage $V_z$ of the Zener diode, it is considered to be in a reverse bias state. Conversely, if the voltage is below this threshold, the diode is in a cut-off state. The expression to calculate the voltage across the Zener diode at any given time can be derived from Equation (2.3).

\begin{equation}
    V_b=\begin{cases}
        V_a, V_b \leq V_z\\
        \frac{V_aR_z+V_zR_s}{R_s+R_z}, V_b>V_z
    \end{cases}
\end{equation}\\

The equation (2) can be utilized to determine the current flowing through the Zener diode:\\

\begin{equation}
    i_z=\frac{V_b-V_z}{R_z}u(V_b-V_z)
\end{equation}\\

In this scenario, the current flowing through the resistor Rs is equal to the current passing through the Zener diode. However, an alternative approach to determine this current through the resistor can also be derived using:\\

\begin{equation}
    i_s=\frac{V_a-V_b}{R_s}
\end{equation}\\

The Equation (1.9) provides the necessary information to determine the current through the diodes:\\

\begin{equation}
    i_d=u(\frac{V_2-V_a}{2}-V_t)(\frac{\frac{V_2-V_a}{2}-V_t}{R_d})
\end{equation}\\

The current through the capacitor can be expressed as follows:\\

\begin{equation}
    i_c=i_s-i_d
\end{equation}\\

\textcolor{blue}{Resistive Load}\\

When considering a resistive load, the characteristics and behavior of the system can be further elaborated. Unlike reactive elements, such as capacitors or inductors, which introduce phase shifts and complex dynamics, resistive loads primarily consist of resistive elements like resistors. These resistive elements do not cause significant phase differences and primarily dissipate electrical energy as heat.

In the specific scenario of a resistive load, the system's equations and calculations revolve around the properties of resistive elements. These elements allow for simpler and more direct mathematical representations, enabling easier analysis and understanding of the system's behavior. By incorporating the appropriate equations and considering the characteristics of resistive loads, we can gain valuable insights into the system's performance, stability, and overall dynamics under these conditions.

In scenarios where it is evident that only one reactive element, specifically a capacitor, is present, the system can be effectively described by a single ordinary differential equation (ODE). Consequently, the resulting equations for $y$ and $y'$ can be expressed as follows:

\begin{equation}
    y=[V_a]
\end{equation}\\

\begin{equation}
    y'=[\frac{dV_a}{dt}]=[\frac{i_c}{C}]
\end{equation}\\

The equation (1.78) provides the derived expression for $y'$ of the Zener diode in its reverse-biased state.\\

\begin{equation}
    \frac{de_2}{dt}=\frac{1}{C}\left(u\left(\frac{V_2-e_2}{2}-V_{th}\right)\left(\frac{\frac{V_2-e_2}{2}-V_{th}}{R_b}\right)-\frac{e_2(R_L+R_z)-R_LV_Z}{R_zR_L+R_s(R_z+R_L)}\right), \text{if } \frac{R_Le_2}{R_s+R_L} \geq V_z
\end{equation}\\

\begin{equation}
    =>y'=\frac{1}{C}[u(\frac{V_2-V_a}{2}-V_t)(\frac{\frac{V_2-V_a}{2}}{R_d}-\frac{e_2(R_L+R_z)-R_LV_Z}{R_zR_L+R_s(R_z+R_L)})]
\end{equation}

The equation (1.65) yields the determined value for $y'$ of the Zener diode when it is in the cut-off state:\\

\begin{equation}
    \frac{d(e_2)}{dt}=\frac{1}{C}\sbracket{\bracket{\frac{\frac{e_1 - e_2}{2} - V_{th}}{R_b}}\cdot u\bracket{\frac{e_1 - e_2}{2} - V_{th}}-\frac{e_2-V_z}{R_s+R_z}} \hspace{0.1cm} \text{for} \hspace{0.1cm} e_2 \geq V_z
\end{equation}

\begin{equation}
    y'=\frac{1}{C}[u(\frac{V_2-V_a}{2}-V_t)(\frac{\frac{V_2-V_a}{2}-V_t}{R_d}-\frac{V_a}{(R_s+R_L)}]
\end{equation}\\

The equations (3.4.3) and (3.4.4) provide a means to calculate the voltage at the capacitor for the next iteration using the Runge-Kutta method, taking into account the state of the Zener diode. Additional parameters can be determined by utilizing the input voltages V2 and Va at each iteration.

The condition for the Zener modes remains the same as described previously. In this particular case, the expression for Vb can be derived using Equation (2.8.2).\\

\begin{equation}
    V_b=\begin{cases}
        \frac{\frac{V_a}{R_s}}{\frac{1}{R_s+\frac{1}{R_L}}}, V_b \leq V_z\\
        \frac{\frac{V_a}{R_s}+\frac{V_z}{R_z}}{\frac{1}{R_s}+\frac{1}{R_L}+\frac{1}{R_z}}, V_b>V_z
    \end{cases}=\begin{cases}
        \frac{R_LV_a}{R_s+R_L}, V_b \leq V_z\\
        \frac{R_zV_a+R_sV_z}{\frac{R_zR_s}{R_L}+R_z+R_s}, V_b>V_z
    \end{cases}
\end{equation}\\

The expression for the current flowing through the load resistance $R_L$ can be expressed as:\\

\begin{equation}
    I_{R_L}=\frac{V_b}{R_L}
\end{equation}\\

All other parameters can be determined using the previously derived equations.

\textcolor{blue}{Inductive Load}\\

 The circuit under consideration involves two reactive elements, namely an inductor and a capacitor. This leads to a more complex system that can be described by a system of ordinary differential equations (ODEs). Consequently, the resulting equations for the vectors $y$ and $y'$, which represent the variables and their derivatives, can be formulated to capture the behavior of the circuit. Taking into account the inductive and capacitive elements, the analysis of this system requires an understanding of the dynamics, interactions, and interplay between these reactive components. By solving the system of ODEs, we can gain insights into the voltage and current relationships, energy transfers, and the overall behavior of the circuit under the influence of both the inductor and the capacitor.\\

In this scenario, the circuit comprises both an inductor and a capacitor as reactive elements. As a result, it is represented by a system of ODEs, where the equations involving the vectors $y$ and $y'$ describe its behavior. Solving these equations provides insights into the circuit's voltage-current relationships and energy dynamics.\\

\begin{equation}
    y=[\frac{V_a}{I_L}]
\end{equation}\\

\begin{equation}
    y'=[\begin{cases}
        \frac{dV_a}{dt}\\
        \frac{dI_L}{dt}
    \end{cases}]=[\begin{cases}
        \frac{i_c}{C}\\
        \frac{V_c}{L}
    \end{cases}]
\end{equation}\\

The equation (1.94) yields the derived expression for $y'$ of the Zener diode in its reverse-biased state:\\

\begin{equation}
    \begin{cases}
        \frac{di_L}{dt}=\frac{1}{L}(\frac{R_ze_2+R_sV_z-i_L(R_s(R_z+R_2)+R_2R_z)}{(R_z+R_s)})\\
        \frac{de_2}{dt}=\frac{1}{C}(u(\frac{V_2-e_2}{2}-V_{th})(\frac{V_2-e_2}{2}-V_{th})(\frac{\frac{V_2-e_2}{2}-V_{th}}{R_b})-\frac{e_2-V_z+i_LR_z}{R_z+R_s}),  \text{if } e_2-R_si_L \geq V_z
    \end{cases}
\end{equation}\\

\begin{equation}
    y'=[\begin{cases}
        \frac{1}{C}(u(\frac{V_2-V_a}{2}-V_t)(\frac{\frac{V_2-V_a}{2}-V_t}{R_d}-\frac{V_a-V_z+i_LR_z}{(R_z+R_s)})\\
        \frac{1}{L}(\frac{R_zV_a+R_sV_z-i_L(R_s(R_z+R_2)+R_2R_z)}{R_z+R_s})
    \end{cases}]
\end{equation}\\

The equation (1.89) provides the determined expression for $y'$ of the Zener diode when it is in the cut-off state.\\

\begin{equation}
    \begin{cases}
        \frac{di_L}{dt}=\frac{1}{L}(e_2-(R_s+R_2)i_L)\\
        \frac{de_2}{dt}=\frac{1}{C}\left(u\left(\frac{V_2-e_2}{2}-V_{th}\right)\left(\frac{V_2-e_2}{2}-V_{th}\right)\left(\frac{\frac{V_2-e_2}{2}-V_{th}}{R_b}\right)-i_L\right), \text{if } e_2-R_si_L<V_z
    \end{cases}
\end{equation}\\

\begin{equation}
    =>y'=[\begin{cases}
        \frac{1}{C}(u(\frac{V_2-V_a}{2}-V_t)(\frac{\frac{V_2-V_a}{2}-V_t}{R_d}-I_L)\\
        \frac{1}{L}(V_a-(R_s+R_2)I_L)
    \end{cases}]
\end{equation}\\

Equations $(3.5.3)$ and $(3.5.4)$ provide a means to determine the voltage across the capacitor and the current flowing through the inductor at the next iteration within the Runge-Kutta algorithm. These calculations depend on the state of the Zener diode. Other parameters can be obtained by considering the input voltage $V_2$, $V_a$, and $I_L$ at each iteration.

The conditions for the Zener modes remain consistent with what has been previously discussed. In this specific scenario, the value of $V_b$ can be derived from Equation $(2.14)$.\\


[need to change this equation to equation 3.5.5 in eugenes]
\begin{equation}
    V_b=\begin{cases}
        V_a-R_sI_L, V_b \leq V_z\\
        \frac{\frac{V_a}{R_s}-I_L+\frac{V_z}{R_z}}{\frac{1}{R_s+\frac{1}{R_z}}}, V_b>V_z
    \end{cases}=\begin{cases}
        V_a-R_sI_L, V_b \leq V_z\\
        \frac{R_z(V_a-I_LR_s)+V_zR_s}{R_s+R_z}, V_b>V_z
    \end{cases} 
\end{equation}\\

The expression for the current flowing through resistor R2 is as follows:\\

\begin{equation}
    I_{R_2}=I_L
\end{equation}\\

The voltage across the inductor Vc can be expressed as:\\

\begin{equation}
    V_c=V_b-R_2I_L
\end{equation}\\

The remaining parameters can be determined utilizing previously derived equations.\\

\textcolor{blue}{Full Load}

The circuit being discussed involves two reactive elements, specifically an inductor and a capacitor. As a result, the behavior of the circuit can be accurately described by a system of ordinary differential equations (ODEs). These equations, involving the vectors $y$ and $y'$, capture the dynamics and interactions between the inductor and capacitor within the circuit.

Now, shifting our focus to the concept of full load, it is important to recognize that full load conditions can significantly impact the performance of a circuit or system. Under full load, the system operates at its maximum or rated capacity, experiencing the highest current or power demand. This state is crucial for evaluating the reliability, efficiency, and functionality of the circuit, ensuring that it can handle the load without compromising its performance.

When examining the behavior of a circuit under full load, considerations such as power consumption, heat dissipation, and voltage stability become paramount. Engineers and designers must carefully size and design the circuit to meet the demands of full load conditions, ensuring safe and efficient operation.

Understanding the behavior of a circuit with reactive elements, as described in your friend's message, allows us to evaluate its performance under full load accurately. By considering the derived equations for $y$ and $y'$ within the context of full load, we can assess the system's capability to handle maximum demands and determine its overall reliability and efficiency under these challenging operating conditions.

\begin{equation}
    y=[V_a\\
    I_L]
\end{equation}

\begin{equation}
    y'=[\frac{dV_a}{dt}\\
    \frac{dI_L}{dt}]=[\frac{i_c}{C}\\
    \frac{V_c}{L}]\\
\end{equation}


$y'$ for Zener in reverse-biased state has been found from the Equations (1.93, 1.94, 1.95, 1.96):\\

\begin{equation}
    y'=[\frac{1}{C}(u(\frac{V_2-e_2}{2}-V_{th})(\frac{V_2-e_2}{2}-V_{th})(\frac{\frac{V_2-e_2}{2}-V_{th}}{R_b})-\frac{V_a(R_z+R_L)+R_L(i_LR_z-V_z)}{(R_s(R_z+R_L)+R_LR_z)}\\
    \frac{1}{L}(R_L\frac{V_aR_z+(V_z-i_LR_z)R_s}{(R_s(R_z+R_L)+R_LR_z)}-R_2i_L)]
\end{equation}\\

The equation (2.21.6) provides the derived expression for $y'$ of the Zener diode when it is in the cut-off state.\\

\begin{equation}
    y'=[\frac{1}{C}(u((\frac{V_2-e_2}{2}-V_{th})(\frac{\frac{V_2-e_2}{2}-V_{th}}{R_b})-\frac{V_a+i_LR_L}{R_s+R_L}\\
    \frac{1}{L}(\frac{-i_L(R_s(R_L+R_2)+R_LR_2)+V_aR_L}{R_s+R_L})]
\end{equation}\\

By utilizing Equations (3.6.3) and (3.6.4), it is possible to determine the voltage across the capacitor and the current flowing through the inductor at the subsequent iteration in the Runge-Kutta algorithm. These calculations are contingent upon the state of the Zener diode. Moreover, by considering the input voltage V2, Va, and IL at each iteration, it becomes feasible to ascertain other parameters.\\

\begin{equation}
    V_b=\begin{cases}
        \frac{\frac{V_a}{R_s}-I_L}{\frac{1}{R_s}+\frac{1}{R_L}}, V_b \leq V_z\\
        \frac{\frac{V_a}{R_s}-I_L+\frac{V_z}{R_z}}{\frac{1}{R_s}+\frac{1}{R_L}+\frac{1}{R_z}}, V_b>V_z
    \end{cases}=\begin{cases}
        R_L\frac{V_a-I_LR_s}{R_L+R_s}, V_b \leq V_z\\
        \frac{R_zV_a-I_LR_sR_z+V_zR_s}{R_s+\frac{R_sR_z}{R_L}+R_z}, V_b>V_z
    \end{cases}
\end{equation}\\

The remaining parameters can be determined by employing previously derived equations.\\

\textcolor{blue}{Switching in Motion}\\

In the realm of switching in motion, as your friend highlighted, the ability to connect or disconnect loads using switches while power is applied to the circuit is a crucial aspect. When dealing with resistive loads, the previously derived equations remain accurate, assuming an ideal resistor with no dynamic response to changes in voltage or current.

For connecting an inductive load, it becomes essential to ensure that the current through the inductor is maintained at $0A$. Under this condition, the aforementioned equations remain valid. However, the model described above does not encompass the scenario when an inductive load is disconnected. Previously, it was assumed that the switch is ideal, leading to instantaneous disconnection as the time interval ($\Delta t$) approaches zero ($\Delta t \to 0s$). However, in practical situations, when the switch is flipped, the current through the inductor will not instantaneously reduce to zero. As a result, the voltage across the inductor can be expressed using the equation [4]:

This highlights the need to consider the dynamics of inductive loads during switching in motion, as the instantaneous reduction of current to zero may not be achieved. Proper analysis and understanding of these dynamics are essential for accurate modeling and effective control of systems involving inductive loads.

\begin{equation}
    V_L=L\frac{di_L}{dt} \approx \lim_{\Delta t \to 0} L\frac{\Delta i_L}{\Delta t}=-Li_L \lim_{\Delta t \to 0} \frac{1}{\Delta t}
\end{equation}\\

Consequently, the solution tends to negative infinity (- $\infty$), which lacks physical significance. In actuality, the voltage will experience a spike; however, within any switch, an electrical breakdown will transpire, preventing the current from instantaneously reducing to zero. It would be more reasonable to model the voltage across the diode in the subsequent cycle after the switch is turned off as:\\

\begin{equation}
    V^{n+1}_L = -\frac{Li^{n}_L}{h}
\end{equation}\\

As a result, the current in the subsequent cycle is $i_L^{n+1} = 0$ (A). Consequently, in all subsequent cycles, both the voltage and current will be zero. Since the resistor is not a reactive element, the voltage across it will also be zero after the switch is flipped.

It is important to note that this model cannot accurately predict the actual voltage across the inductor. Instead, it serves to indicate a surge in the inductor voltage after it is disconnected from the power supply.\\

\textcolor{blue}{Implementation of Numerical Algorithm for Circuit Analysis}\\

The implementation of the numerical algorithm for the circuit analysis involved the development of a MATLAB function m-file, utilizing the derived equations as discussed earlier. This m-file takes various inputs, including the current voltage across the Zener diode, capacitor, and the current flowing through the inductor. Additionally, the input voltage at the present, intermediate, and next iteration is provided to determine the slopes at different time intervals. The timestep value, mode of operation, and relevant parameters of the circuit are also considered as inputs, as they may vary.

The MATLAB function m-file then performs the necessary calculations and computations to determine all the currents and voltages in the circuit for the next iteration. By utilizing the numerical algorithm and considering the changing inputs, the function provides a comprehensive analysis of the circuit dynamics, facilitating the evaluation of various parameters and their impact on the circuit's behavior.

This implementation enables efficient and accurate simulation and analysis of the circuit, allowing for insights into its performance under different operating conditions. It serves as a valuable tool for engineers and researchers in studying and optimizing circuit designs, understanding the effects of parameter variations, and making informed decisions for circuit improvement.\\

[Code Section 1]\\

\emph{Figure 3.1: MATLAB Function M-File for Computing Voltages and Currents in the Circuit at Time n+1}\\

\textcolor{blue}{Refining Timestep Selection for Accurate Circuit Analysis}\\


To determine an appropriate timestep for the numerical algorithm, the input to the circuit, in this case, is a mains signal with a frequency of 50 Hz. Through a process of trial and error, it was found that a timestep of 20 μs, resulting in 1000 cycles per second, is sufficient for accurate simulations. However, it is sensible to verify this choice by comparing the results with a smaller timestep, such as 10 μs, which is half the size of 20 μs. If the difference between the resulting waveforms produced by the RungeKuttaCircuit using both timesteps is negligible, it indicates that the chosen timestep size is acceptable.

To conduct this comparison, the voltage across the capacitor (Va) and the voltage across the load (Vb) can be analyzed during the first second after the power is supplied. This analysis should be performed for all four modes of operation, taking into account the nominal values of the resistor (Rs) and capacitor (C).

By evaluating the waveforms and assessing the level of deviation between the two timesteps, engineers and researchers can confidently determine if the timestep of 20 μs is appropriate for accurately capturing the circuit behavior. This verification process helps ensure that the chosen timestep strikes a balance between computational efficiency and accuracy, resulting in reliable simulations for further analysis and evaluation.\\

[Graph for Circuit Parameters versus time without load]\\

\emph{Figure 3.2.1: Voltage across the load and capacitor, and current through the Zener diode under no-load conditions}\\

In the absence of a load, the circuit operates as anticipated. Initially, the output voltage tracks the input voltage until it surpasses the Zener threshold. Subsequently, as the Zener diode enters reverse bias, the load voltage is clamped and maintains a relatively stable value at around 6.5 V. At this juncture, the Zener diode begins to conduct, aligning with the expected behavior.\\

[insert graph for figure 3.2.2]\\

\emph{Figure 3.2.2: Voltage across the load and capacitor, and current through the Zener diode with a resistive load
}\\

% Figure 3.2.2: Load and capacitor voltages and current through the Zener with a resistive load

When simulating the circuit with a resistive load, the output voltage also undergoes clipping. However, due to the voltage divider formed by resistors Rs and RL, it no longer tracks the input waveform. As a result, it takes more time for the output voltage to stabilize. Additionally, it can be observed that the inclusion of a resistor in parallel with the Zener diode leads to a reduction in the steady-state current flowing through the Zener.

The equations for this scenario can be expressed as follows:

- Voltage across the load ($V_L$):
\[V_L = V_{out}\]

- Voltage across the capacitor ($V_c$):
\[V_c = V_{out}\]

- Current through the Zener diode ($I_Z$):
\[I_Z = \frac{V_{out} - V_Z}{R_Z}\]

Please note that in the above equations, $V_{out}$ represents the output voltage, $V_Z$ represents the Zener voltage, and $R_Z$ represents the resistance of the Zener diode.\\

[insert figure 3.2.3]\\

\emph{Figure 3.2.3: Voltage across the load and capacitor, and current through the Zener diode with an inductive load}\\

By examining Figure 3.2.3, it becomes evident that the circuit is unable to provide sufficient current to cause the output voltage to clip when an inductive load is connected. As a result, a noticeable ripple appears in the output waveform, whereas in previous cases, the Zener diode effectively reduced such ripple.\\

[insert Figure 3.2.4]\\

\emph{Figure 3.2.4: Voltage across the load and capacitor, and current through the Zener diode with the full load}\\

% Figure 3.2.4: Load and capacitor voltages and current through the Zener with the full load

When the full load is connected to the DC rectifier, the steady-state mean output voltage is further reduced, as the resistive load also draws a portion of the current.

In summary, the output waveforms for different time steps are the same, indicating that a timestep of 20 μs is sufficiently small for a single iteration of the Runge-Kutta method in stable operation.

The overall trend in each case is evident and consistent with what is observed in actual AC-DC converters [3]. The capacitor takes time to charge and, depending on the connected load, stabilizes at a voltage between 12 and 14V. The charging curve resembles that of real capacitors when charged from a DC source. The main difference between the outputs of the RC circuit and the examined circuit is that the curve is not exactly exponential due to the capacitor being charged in steps, which is a result of the sinusoidal input passed through the Wien bridge.

In steady state, there is ripple added to the DC output due to the constant charging and discharging of the capacitor caused by the changing input voltage. However, this ripple effect is negligible in each case.

It is important to note that when the inductive load is connected, the output voltage is so low that the Zener diode is always in the cut-off state. This is realistic because the voltage across the inductor depends on the derivative of the current flowing through it. As the DC rectifier effectively stabilizes the output voltage and the ripple is minimal, the inductor barely contributes to the load impedance when connected. Therefore, it can be assumed that the output voltage is approximately equivalent to the output of a voltage divider formed by resistors R2 and Rs:

\[V_b \approx \frac{R2}{R2 + Rs} \cdot V_a\]   (3.9)

Overall, it can be concluded that using the Runge-Kutta method has yielded sensible results, and there is no need to implement a different numerical method.\\

The estimation of the maximal current through the diodes, as mentioned by your friend, is an important consideration in the modeling of the circuit. With the use of the RungeKuttaCircuit command, it becomes possible to compare and analyze the current flowing through the diodes in all four possible modes of operation.

\textcolor{blue}{Maximal Diode Current: Analysis and Implications}\\

During the modeling process, it is crucial to ensure that the current flowing through the diodes remains within acceptable limits. By comparing the simulated or calculated currents with the estimated maximal current of approximately 2.227 A, engineers can assess whether the diodes are operating within their specified range.

Exceeding the maximal current rating of the diodes can lead to detrimental effects such as increased power dissipation, voltage drops, and potential failure of the diodes. Therefore, monitoring and analyzing the diode currents in different modes of operation using the RungeKuttaCircuit command allows for a comprehensive assessment of their performance and adherence to the specified limits.

Overall, considering the estimated maximal current through the diodes and utilizing the RungeKuttaCircuit command, engineers can gain valuable insights into the current behavior and ensure the diodes' reliable operation within the established limits.\\

[insert figure 3.3]\\

\emph{Figure 3.3: Current through the diode bridge in various operating modes}\\

As observed, the current through the diode bridge is maximized when the full load is connected. As the capacitor charges to its steady-state voltage, the current through the diodes tends to decrease, which aligns with expectations.

Furthermore, the maximal current passing through the diodes is measured to be 2.2275 A. This value corresponds to the previous prediction, providing additional evidence that the model and approximation are mutually consistent.\\

\textcolor{blue}{Analysis of Nominal Values and Variation in Load Voltage}\\

To gain insights into the behavior of the circuit under normal operating conditions, it is essential to analyze the nominal values of its components. This analysis includes considering the tolerances of resistor Rs and capacitor C, as outlined in Table 1. 

The load voltage in the circuit will inherently vary based on the actual values of capacitance C and resistance R. These variations have an impact on the peak-to-peak output voltages and mean values in different modes of operation. A summary of these values is provided in the table below:\\

\begin{table}[htbp]
\centering
\caption{Analysis of Circuit Values}
\begin{tabular}{|c|c|c|c|c|}
\hline
\textbf{Mode} & \textbf{Capacitance C (mF)} & \textbf{Resistance Rs ($\Omega$)} & \textbf{Mean Output Voltage Vb (V)} & \textbf{Peak-to-Peak Output Voltage Vb (mV)} \\
\hline
No Load & 2.2 & 270 & 6.646 & 1.887 \\
& 2.64 & 243 & 6.660 & 1.9 \\
& 1.76 & 243 & 6.660 & 2.85 \\
& 2.64 & 297 & 6.634 & 1.324 \\
& 1.76 & 297 & 6.634 & 1.985 \\
\hline
Resistive Load & 2.2 & 270 & 6.527 & 1.878 \\
& 2.64 & 243 & 6.542 & 1.892 \\
& 1.76 & 243 & 6.542 & 2.837 \\
& 2.64 & 297 & 6.515 & 1.317 \\
& 1.76 & 297 & 6.515 & 1.976 \\
\hline
Inductive Load & 2.2 & 270 & 2.693 & 47.989 \\
& 2.64 & 243 & 2.914 & 45.832 \\
& 1.76 & 243 & 2.914 & 68.674 \\
& 2.64 & 297 & 2.504 & 35.268 \\
& 1.76 & 297 & 2.504 & 52.844 \\
\hline
Full Load & 2.2 & 270 & 2.270 & 38.564 \\
& 2.64 & 243 & 2.463 & 37.162 \\
& 1.76 & 243 & 2.463 & 55.689 \\
& 2.64 & 297 & 2.105 & 28.117 \\
& 1.76 & 297 & 2.105 & 42.132 \\
\hline
\end{tabular}
\end{table}

\emph{Table 3.1: Output Voltage Ranges in Various Modes of Operation}\\

From the table above, it is evident that the mean output voltage increases as the resistance value $R_s$ decreases. The output ripple is influenced by the time constant $\tau = R_sC$, where a higher time constant leads to a reduced ripple and vice versa. This behavior aligns with the expected characteristics of a typical RC circuit.

To ensure proper operation, resistor $R_s$ should not exceed a power dissipation of $0.5$ W. It is important to note that this power rating is typically a continuous rating, and the peak transient energy dissipation rate is not provided. The power loss in the resistor due to heat is governed by Joule's Law:

\[ P = I^2R \]

where $P$ represents the power, $I$ is the current passing through the resistor, and $R$ is the resistance value.\\

\begin{equation}
    P=RI^2
\end{equation}\\

In the context of resistor dissipation, the power dissipated in a resistor ($P$) can be calculated using Joule's Law:

\[ P = I^2R \]

where $I$ represents the current flowing through the resistor and $R$ denotes the resistance value.

It is worth noting that the maximum continuous voltage drop across resistor $R_s$ occurs when tested with the full load, as depicted in Figures (3.2). Therefore, it would be reasonable to simulate the circuit in that specific mode to determine the peak power load.

Additionally, it is evident that increasing the capacitance would result in a longer charging time, but it should not have a significant impact on the steady-state output current or voltage. On the other hand, decreasing the resistance would increase the current flow, leading to a higher power dissipation in the resistor according to Joule's Law. These assumptions can be verified by conducting simulations and varying the resistance and capacitance values in a full-load scenario.\\

[insert figure 3.4]\\

\emph{Figure 3.4 illustrates the power dissipated in the resistor $R_s$ for various combinations of capacitance $C$ and resistance $R_s$}\\

The table below displays the average power dissipation values:\\

\begin{table}[h]
\centering
\caption{Mean power dissipated in resistor Rs in steady state}
\begin{tabular}{ccc}
\hline
Capacitance C (mF) & Resistance Rs (Ω) & Mean power dissipated (mW) \\
\hline
2.2                & 270               & 486.6                      \\
2.64               & 243               & 515.8                      \\
1.76               & 243               & 515.6                      \\
2.64               & 297               & 460.3                      \\
1.76               & 297               & 460.3                      \\
\hline
\end{tabular}
\end{table}\\

\emph{Table 3.2: Mean power dissipation for varying Rs and C values}\\

Based on Figure 3.4 and Table 3.2, it is evident that the tolerance of the capacitor has minimal impact on the average steady-state power dissipation. However, increasing the capacitance results in a longer time to reach steady state and a smaller ripple in the steady state.

Decreasing the resistance does increase the power dissipation in the resistor, and it should be noted that when the resistor approaches its minimum value, the power dissipation exceeds the $1/2$ W threshold. Therefore, it is advisable to select a resistor with a power rating of at least $3/4$ W or a better tolerance.\\

In addition to the information provided, it is also important to investigate the behavior of the circuit when switches are opened and closed while power is applied. This scenario allows us to analyze the effects of switching on the output voltage. Specifically, we will examine the following scenario:\\

\begin{table}[h]
\centering
\caption{Switching Events and Corresponding Times}
\begin{tabular}{|c|c|}
\hline
\textbf{Event} & \textbf{Time (s)} \\
\hline
Power is applied & 0 \\
\hline
Resistive load is turned on & 2 \\
\hline
Inductive load is turned on & 4.2 \\
\hline
Inductive load is turned off & 5.863 \\
\hline
\end{tabular}
\end{table}
\emph{Table 3.3 showcases the chronological sequence of events in the switching scenario. It highlights the specific timings at which each event occurs}\\

To ensure accurate simulation results in the switching scenario, it is important to minimize the timestep before any load is connected or disconnected. This is due to the idealized assumption that the switches open and close instantaneously. By approaching the initial conditions as closely as possible, precision can be maintained.

To achieve this, a geometric series approach can be employed. The last 20 μs cycle before switching is divided into 12 smaller cycles, with the timestep reduced by a factor of 2 in each iteration except the last one. This results in timesteps of 10, 5, 2.5, ... 10/211, and 10/211 μs. The final two steps are approximately 4.88 ns each, allowing for highly accurate initial conditions after the switching event and minimizing errors.

The switching scenario can be implemented using the function-m file RungeKuttaCircuit described previously. In MATLAB, the implementation would involve writing a script that calls the RungeKuttaCircuit function with the appropriate inputs and parameters. This enables the simulation of the circuit's behavior during the switching events.\\

[matlab code figure 3.5]\\

\emph{Figure 3.5: MATLAB script for generating outputs in the switching scenario}\\

This script generates the following output:\\

[insert figure 3.6 matlab plot generated]\\

\emph{Figure 3.6 illustrates the voltages and currents observed in the switching scenario}\\

The observed behavior in the switching scenario aligns with expectations. Following each event, the circuit undergoes a transient state before eventually stabilizing into a steady state. The charging and discharging curves of the capacitor exhibit the anticipated behavior. The current through the inductor is present only when the inductive load is connected, and it gradually reduces as the steady state is established.

It is noteworthy that when the inductive load is connected, the voltage at the inductor experiences a spike that is limited by the Zener diode voltage. Conversely, when the load is disconnected, a large negative peak is observed. However, our model cannot precisely determine the exact voltage at this peak, as discussed previously with Equation (3.7). According to the model, the voltage would be infinite, which is not realistic. In reality, when a mechanical switch is used, electrical breakdown occurs upon disconnection, allowing some current to flow through the inductor. As a result, the output voltage does not reach infinity.\\






























\subsection{Numerical Algorithim}
\subsection{Timestep Scale}
\subsection{Maximial Diode Current}